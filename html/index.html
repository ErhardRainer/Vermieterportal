<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Immobilien-Detailansicht</title>

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Inter Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Chart.js CDN f√ºr das Wasserfalldiagramm -->
  <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

  <!-- Lucide Icons (Browser/UMD) - NICHT lucide-react -->
  <script defer src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

  <!-- Custom CSS -->
  <link rel="stylesheet" href="./styles.css" />
</head>
<body class="bg-gray-100 p-4 lg:p-8">
  <div class="max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
    <div class="flex flex-col">
      <!-- HERO: Bildergalerie oben, gleich hohe Fl√§che -->
      <div class="w-full relative group h-[280px] md:h-[350px] lg:h-[400px]">
        <!-- Bild-Container (WICHTIG: muss existieren) -->
        <div id="image-gallery" class="relative h-full w-full overflow-hidden"></div>

        <!-- Pfeil Links -->
        <button id="prev-image" class="absolute top-1/2 left-3 -translate-y-1/2 bg-white/70 p-2 rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-white focus:outline-none" aria-label="Vorheriges Bild">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg>
        </button>
        <!-- Pfeil Rechts -->
        <button id="next-image" class="absolute top-1/2 right-3 -translate-y-1/2 bg-white/70 p-2 rounded-full shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 hover:bg-white focus:outline-none" aria-label="N√§chstes Bild">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>
        </button>
        <!-- Bildz√§hler -->
        <div id="image-counter" class="absolute bottom-4 right-4 bg-black/50 text-white text-sm px-3 py-1 rounded-full select-none">1 / 4</div>

        <!-- Overlay-Infokarte (nur Desktop) -->
        <div class="hidden md:block absolute top-6 right-6 max-w-md z-10">
          <div class="bg-white/95 backdrop-blur rounded-xl shadow-xl p-5">
            <h1 class="text-2xl font-bold text-gray-900">Moderne 3-Zimmer-Wohnung im Zentrum</h1>
            <p class="text-xl font-semibold text-blue-600 mt-2">Mietkosten: von 800 ‚Ç¨</p>
            <p class="text-gray-600 mt-1 flex items-center gap-2"><span id="address-text-desktop">Hauptstra√üe 10, 10115 Berlin</span><a id="map-link-desktop" href="https://www.google.com/maps/search/?api=1&query=Hauptstra√üe%2010%2C%2010115%20Berlin" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-blue-600 hover:text-blue-700" aria-label="In Google Maps √∂ffnen" title="In Google Maps √∂ffnen"><i data-lucide="paperclip" class="w-4 h-4">üìé</i></a></p>
          </div>
        </div>
      </div>

      <!-- Mobile: Titel unter dem Bild -->
      <div class="md:hidden p-6 lg:p-8">
        <h1 class="text-3xl font-bold text-gray-900">Moderne 3-Zimmer-Wohnung im Zentrum</h1>
        <p class="text-2xl font-semibold text-blue-600 mt-2">Mietkosten: von 800 ‚Ç¨</p>
        <p class="text-gray-600 mt-1 flex items-center gap-2"><span id="address-text-mobile">Hauptstra√üe 10, 10115 Berlin</span><a id="map-link-mobile" href="https://www.google.com/maps/search/?api=1&query=Hauptstra√üe%2010%2C%2010115%20Berlin" target="_blank" rel="noopener noreferrer" class="inline-flex items-center text-blue-600 hover:text-blue-700" aria-label="In Google Maps √∂ffnen" title="In Google Maps √∂ffnen"><i data-lucide="paperclip" class="w-4 h-4">üìé</i></a></p>
      </div>

      <!-- Tabs & Inhalte: volle Breite unter dem Bild -->
      <div class="w-full p-6 lg:p-8">
        <!-- Tab-Navigation -->
        <div class="border-b border-gray-200 mt-2">
          <nav id="tab-buttons" class="flex flex-wrap -mb-px space-x-6" aria-label="Tabs" role="tablist">
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="allgemein" role="tab" aria-selected="false">Allgemein</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="dokumente" role="tab" aria-selected="false">Mietvertr√§ge</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="kontakt" role="tab" aria-selected="false">Kontakt</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="lage" role="tab" aria-selected="false">Lage</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="handwerker" role="tab" aria-selected="false">Handwerker</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="kontaktformular" role="tab" aria-selected="false">Nachrichten</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="betriebsanleitungen" role="tab" aria-selected="false">Betriebsanleitungen</button>
            <button class="tab-button tab-inactive border-b-2 border-transparent pb-2" data-tab="maengelliste" role="tab" aria-selected="false">M√§ngelliste</button>
            <!-- Start-Tab -->
            <button class="tab-button tab-active border-b-2 pb-2" data-tab="betriebskosten" role="tab" aria-selected="true">Betriebskosten</button>
          </nav>
        </div>

        <!-- Tab-Inhalte -->
        <div id="tab-content" class="mt-6">
          <!-- Allgemein Tab -->
          <div class="tab-pane hidden" data-tab-content="allgemein" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">√úberblick</h2>
            <ul class="space-y-2 text-gray-700">
              <li class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home mr-3 text-blue-500"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                Wohnfl√§che: 85 m¬≤
              </li>
              <li class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bed-double mr-3 text-blue-500"><path d="M2 16v-2a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v2"/><path d="M2 12v-2a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v2"/><path d="M4 12V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4"/><path d="M2 20h20"/><path d="M4 16v4"/><path d="M20 16v4"/></svg>
                Zimmer: 3
              </li>
              <li class="flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bath mr-3 text-blue-500"><path d="M9 6 6.5 3.5a1.5 1.5 0 0 0-1-.5C4.4 3 3 4.4 3 6c0 1.2.8 2.2 1.8 2.6l3.2 1.4"/><path d="m21 6-2.5-2.5a1.5 1.5 0 0 0-1-.5c-1.1 0-2.5 1.4-2.5 3 0 1.2.8 2.2 1.8 2.6l3.2 1.4"/><path d="M3 21h18v-2a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v2Z"/><path d="M5 15v-1a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v1"/></svg>
                Badezimmer: 1
              </li>
            </ul>
            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-2">Beschreibung</h3>
            <p class="text-gray-700 leading-relaxed">Diese helle und modern geschnittene 3-Zimmer-Wohnung befindet sich in einer begehrten Lage im Zentrum. Sie besticht durch bodentiefe Fenster, einen offenen Wohn-Essbereich und einen sonnigen Balkon. Hochwertiges Parkett und eine moderne Einbauk√ºche runden das Angebot ab.</p>

            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Dokumente zur Wohnung</h3>
            <ul class="space-y-3">
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Grundriss (PDF)</span>
                </a>
              </li>
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cube mr-3 text-blue-500"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><path d="M3.27 6.96 12 12l8.73-5.04"/><path d="M12 22V12"/></svg>
                  <span class="font-medium text-gray-800">3D Modell</span>
                </a>
              </li>
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Energieausweis (PDF)</span>
                </a>
              </li>
            </ul>
          </div>

          <!-- Mietvertr√§ge Tab (ehem. Dokumente) -->
          <div class="tab-pane hidden" data-tab-content="dokumente" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Mietvertr√§ge</h2>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Allgemeines</h3>
                <ul class="space-y-2 text-gray-700">
                  <li class="flex items-center"><span class="w-56 text-gray-500">Beginn des Mietvertrages:</span><span>01.03.2020</span></li>
                  <li class="flex items-center"><span class="w-56 text-gray-500">Befristung des Mietvertrages:</span><span>Nein</span></li>
                  <li class="flex items-center"><span class="w-56 text-gray-500">Verl√§ngerung des Mietvertrages am:</span><span>‚Äî</span></li>
                </ul>
              </div>
              <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Dokumente</h3>
                <ul class="space-y-3">
                  <li>
                    <a href="#" class="flex items-center p-3 bg-white rounded-lg hover:bg-gray-50 transition duration-150 border border-gray-200">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                      <span class="font-medium text-gray-800">Mietvertrag</span>
                    </a>
                  </li>
                  <li>
                    <a href="#" class="flex items-center p-3 bg-white rounded-lg hover:bg-gray-50 transition duration-150 border border-gray-200">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                      <span class="font-medium text-gray-800">Haustiererlaubnis</span>
                    </a>
                  </li>
                  <li>
                    <a href="#" class="flex items-center p-3 bg-white rounded-lg hover:bg-gray-50 transition duration-150 border border-gray-200">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                      <span class="font-medium text-gray-800">Garagenmietvertrag</span>
                    </a>
                  </li>
                  <li>
                    <a href="#" class="flex items-center p-3 bg-white rounded-lg hover:bg-gray-50 transition duration-150 border border-gray-200">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                      <span class="font-medium text-gray-800">Verl√§ngerung des Mietvertrags</span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Kontakt Tab (neu) -->
          <div class="tab-pane hidden" data-tab-content="kontakt" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Kontakt</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Kontakt des Vermieters</h3>
                <ul class="space-y-2 text-gray-700">
                  <li><span class="text-gray-500">Name:</span> Max Vermieter</li>
                  <li><span class="text-gray-500">Adresse:</span> Musterstra√üe 1, 10115 Berlin</li>
                  <li><span class="text-gray-500">Telefon:</span> <a class="text-blue-600 hover:underline" href="tel:+4930123456">+49 30 123456</a></li>
                  <li><span class="text-gray-500">Email:</span> <a class="text-blue-600 hover:underline" href="mailto:vermieter@example.com">vermieter@example.com</a></li>
                </ul>
              </div>
              <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Kontakt des Mieters</h3>
                <ul class="space-y-2 text-gray-700">
                  <li><span class="text-gray-500">Name:</span> Erika Mieterin</li>
                  <li><span class="text-gray-500">Adresse:</span> Hauptstra√üe 10, 10115 Berlin</li>
                  <li><span class="text-gray-500">Telefon:</span> <a class="text-blue-600 hover:underline" href="tel:+491751234567">+49 175 1234567</a></li>
                  <li><span class="text-gray-500">Email:</span> <a class="text-blue-600 hover:underline" href="mailto:mieter@example.com">mieter@example.com</a></li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Lage Tab -->
          <div class="tab-pane hidden" data-tab-content="lage" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Standort auf der Karte</h2>
            <div class="w-full h-[500px] md:h-[650px] lg:h-[750px] rounded-lg overflow-hidden border border-gray-200">
              <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2427.631031301903!2d13.402360215807494!3d52.52000837981389!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47a851c13416a4e3%3A0x86770e64c83e449c!2sAlexanderplatz!5e0!3m2!1sde!2sde!4v1678886000001" width="100%" height="100%" style="border:0;" allowfullscreen loading="lazy" referrerpolicy="no-referrer-when-downgrade" title="Kartenansicht"></iframe>
            </div>
            <p class="mt-4 text-gray-700">Die Immobilie befindet sich in zentraler Lage. Die genaue Adresse lautet: Hauptstra√üe 10, 10115 Berlin.</p>
          </div>

          <!-- Handwerker Tab -->
          <div class="tab-pane hidden" data-tab-content="handwerker" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Empfohlene Dienstleister</h2>
            <div class="lg:flex lg:space-x-8">
              <div class="w-full lg:w-1/2">
                <ul id="tradesmen-list" class="space-y-2"><!-- Items via JS --></ul>
              </div>
              <div class="w-full lg:w-1/2 mt-6 lg:mt-0 p-4 bg-gray-50 rounded-lg shadow-inner border border-gray-200">
                <div id="tradesman-details">
                  <p class="text-gray-500">W√§hlen Sie einen Dienstleister aus der Liste links, um seine Kontaktdaten anzuzeigen.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Betriebsanleitungen Tab (neu) -->
          <div class="tab-pane hidden" data-tab-content="betriebsanleitungen" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Betriebsanleitungen</h2>
            <ul class="space-y-3">
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Herd ‚Äì Bedienungsanleitung</span>
                </a>
              </li>
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Geschirrsp√ºler ‚Äì Bedienungsanleitung</span>
                </a>
              </li>
            </ul>
          </div>

          <!-- M√§ngelliste Tab (neu) -->
          <div class="tab-pane hidden" data-tab-content="maengelliste" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">M√§ngelliste</h2>
            <p class="text-gray-600 mb-4">Dokumentation von M√§ngeln als Tabelle. √úber das Bildsymbol √∂ffnen Sie die Bildergalerie mit Beschreibung.</p>

            <!-- Defekt-Viewer (Overlay) -->
            <div id="defect-viewer" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center" role="dialog" aria-modal="true" aria-labelledby="defect-viewer-title">
              <div class="bg-white rounded-xl shadow-2xl w-full max-w-3xl mx-4 overflow-hidden">
                <div class="flex items-center justify-between px-4 py-3 border-b border-gray-200">
                  <h3 id="defect-viewer-title" class="text-lg font-semibold text-gray-800">Mangel</h3>
                  <button id="defect-viewer-close" class="p-2 text-gray-500 hover:text-gray-700" aria-label="Schlie√üen">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                  </button>
                </div>
                <div class="px-4 pt-4">
                  <!-- Bildbereich mit Navigation -->
                  <div class="relative w-full h-64 md:h-96 bg-gray-50 rounded-lg border border-gray-200 overflow-hidden">
                    <img id="defect-viewer-image" src="" alt="Defektbild" class="absolute inset-0 w-full h-full object-contain" />
                    <button id="defect-prev" class="absolute top-1/2 left-3 -translate-y-1/2 bg-white/80 p-2 rounded-full shadow hover:bg-white" aria-label="Vorheriges Bild">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><polyline points="15 18 9 12 15 6"></polyline></svg>
                    </button>
                    <button id="defect-next" class="absolute top-1/2 right-3 -translate-y-1/2 bg-white/80 p-2 rounded-full shadow hover:bg-white" aria-label="N√§chstes Bild">
                      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>
                    </button>
                    <div id="defect-counter" class="absolute bottom-2 right-2 bg-black/50 text-white text-xs px-2 py-1 rounded-full select-none">1 / 1</div>
                  </div>
                  <!-- Beschreibung -->
                  <p id="defect-viewer-description" class="text-gray-700 leading-relaxed mt-4 mb-4">Beschreibung zum Mangel.</p>
                </div>
                <div class="px-4 pb-4 flex justify-end border-t border-gray-200">
                  <button id="defect-viewer-close-2" class="mt-3 inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700">Schlie√üen</button>
                </div>
              </div>
            </div>

            <!-- Tabelle der M√§ngel -->
            <div class="overflow-x-auto bg-white rounded-lg border border-gray-200">
              <table class="min-w-full divide-y divide-gray-200" aria-label="M√§ngeltabelle">
                <thead class="bg-gray-50">
                  <tr>
                    <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mangel</th>
                    <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Raum</th>
                    <th scope="col" class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Bilder</th>
                  </tr>
                </thead>
                <tbody id="defects-tbody" class="bg-white divide-y divide-gray-200">
                  <tr>
                    <td class="px-4 py-3 text-gray-800">Kratzer am Parkett nahe Balkont√ºr</td>
                    <td class="px-4 py-3 text-gray-600">Wohnzimmer</td>
                    <td class="px-4 py-3">
                      <button class="defect-view-btn inline-flex items-center px-3 py-2 text-sm text-blue-600 hover:text-blue-700" data-defect-id="def1" aria-label="Bilder anzeigen">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-images mr-2"><path d="M3 7v10a2 2 0 0 0 2 2h12"/><path d="M8 7V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-2"/><path d="m21 15-5-5L5 21"/><path d="M5 16l3-3"/></svg>
                        Bilder
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td class="px-4 py-3 text-gray-800">Lose Silikonfuge an der Dusche</td>
                    <td class="px-4 py-3 text-gray-600">Bad</td>
                    <td class="px-4 py-3">
                      <button class="defect-view-btn inline-flex items-center px-3 py-2 text-sm text-blue-600 hover:text-blue-700" data-defect-id="def2" aria-label="Bilder anzeigen">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-images mr-2"><path d="M3 7v10a2 2 0 0 0 2 2h12"/><path d="M8 7V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-2"/><path d="m21 15-5-5L5 21"/><path d="M5 16l3-3"/></svg>
                        Bilder
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td class="px-4 py-3 text-gray-800">Schublade links klemmt</td>
                    <td class="px-4 py-3 text-gray-600">K√ºche</td>
                    <td class="px-4 py-3">
                      <button class="defect-view-btn inline-flex items-center px-3 py-2 text-sm text-blue-600 hover:text-blue-700" data-defect-id="def3" aria-label="Bilder anzeigen">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-images mr-2"><path d="M3 7v10a2 2 0 0 0 2 2h12"/><path d="M8 7V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-2"/><path d="m21 15-5-5L5 21"/><path d="M5 16l3-3"/></svg>
                        Bilder
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- Nachrichten Tab (ehem. Kontaktformular) -->
          <div class="tab-pane hidden" data-tab-content="kontaktformular" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Nachrichten</h2>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <!-- Verlauf -->
              <div class="lg:col-span-2 p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Verlauf</h3>
                <ul class="space-y-4" aria-live="polite">
                  <li class="p-3 bg-white rounded-lg border border-gray-200">
                    <div class="text-sm text-gray-500">01.10.2024 ‚Ä¢ Vermieter</div>
                    <div class="text-gray-800">Die Wartung der Heizung findet n√§chste Woche statt.</div>
                  </li>
                  <li class="p-3 bg-blue-50 rounded-lg border border-blue-200">
                    <div class="text-sm text-gray-500">02.10.2024 ‚Ä¢ Mieter</div>
                    <div class="text-gray-800">Vielen Dank f√ºr die Info. Passt f√ºr mich.</div>
                  </li>
                  <li class="p-3 bg-white rounded-lg border border-gray-200">
                    <div class="text-sm text-gray-500">15.10.2024 ‚Ä¢ Vermieter</div>
                    <div class="text-gray-800">Bitte beachten Sie die neue Hausordnung im Anhang.</div>
                  </li>
                </ul>
              </div>
              <!-- Neue Nachricht -->
              <div class="p-4 bg-gray-50 rounded-lg border border-gray-200">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Neue Nachricht</h3>
                <form action="#" method="POST">
                  <div class="space-y-4">
                    <div>
                      <label for="kategorie" class="block text-sm font-medium text-gray-700">Kategorie</label>
                      <select id="kategorie" name="kategorie" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md shadow-sm">
                        <option value="allgemein">Allgemein</option>
                        <option value="reparatur">Reparatur</option>
                        <option value="dokumente">Dokumente</option>
                      </select>
                    </div>
                    <div>
                      <label for="nachricht_formular" class="block text-sm font-medium text-gray-700">Nachricht</label>
                      <textarea id="nachricht_formular" name="nachricht_formular" rows="6" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" placeholder="Ihre Nachricht..."></textarea>
                    </div>
                    <div>
                      <button type="submit" class="w-full inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Senden</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <!-- Betriebskosten Tab (MIT WATERFALL-DIAGRAMM) -->
          <div class="tab-pane" data-tab-content="betriebskosten" role="tabpanel">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Betriebskosten (Jahres√ºbersicht)</h2>

            <div class="flex items-center space-x-3 mb-4">
              <label for="year-select" class="text-sm font-medium text-gray-700">Jahr ausw√§hlen:</label>
              <select id="year-select" class="block pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md shadow-sm w-32">
                <option value="2024">2024</option>
                <option value="2023">2023</option>
                <option value="2022">2022</option>
              </select>
            </div>

            <!-- Zusammenfassung des Ergebnisses -->
            <div id="summary-card" class="p-4 rounded-lg mb-6 shadow-md transition-all duration-300">
              <p class="text-lg font-semibold text-gray-800">Gesamtergebnis:</p>
              <div class="flex justify-between items-center mt-2">
                <span class="text-sm font-medium text-gray-600">Jahresgesamtkosten (Ist):</span>
                <span id="actual-total-cost" class="text-lg font-bold"></span>
              </div>
              <div class="flex justify-between items-center mt-1">
                <span class="text-sm font-medium text-gray-600">Vorauszahlungen (Soll):</span>
                <span id="prepayment-total" class="text-lg font-bold"></span>
              </div>
              <hr class="my-3" />
              <div class="flex justify-between items-center">
                <span class="text-lg font-semibold">Endabrechnung:</span>
                <span id="final-settlement" class="text-xl font-bold"></span>
              </div>
            </div>

            <h3 class="text-lg font-semibold text-gray-800 mb-3">Monats√ºbersicht (Wasserfall)</h3>
            <div class="relative w-full h-80 bg-gray-50 p-2 rounded-lg border border-gray-200">
              <canvas id="waterfallChart" aria-label="Wasserfalldiagramm Betriebskosten" role="img"></canvas>
            </div>
            
            <!-- Dokumente zu Betriebskosten -->
            <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">Dokumente</h3>
            <ul class="space-y-3">
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Betriebskostenabrechnung 2022</span>
                </a>
              </li>
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Betriebskostenabrechnung 2023</span>
                </a>
              </li>
              <li>
                <a href="#" class="flex items-center p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition duration-150">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-text mr-3 text-blue-500"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" x2="8" y1="13" y2="13"></line><line x1="16" x2="8" y1="17" y2="17"></line><line x1="10" x2="8" y1="9" y2="9"></line></svg>
                  <span class="font-medium text-gray-800">Vorschreibung 2024</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Custom JavaScript -->
  <script src="./app.js"></script>
</body>
</html>
